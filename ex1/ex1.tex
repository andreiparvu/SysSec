\documentclass[a4paper,11pt]{article}

\usepackage[T1]{fontenc}
\usepackage{ae, aecompl}
\usepackage{a4wide}
\usepackage{boxedminipage}
\usepackage{url}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage{ucs}
\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}

% IMPORTANT: add or remove (comment out) the boolean '\solutiontrue' below to
% create the solution document or the exercise document respectively.
% First we create the switch to make either the exercises or the solutions
\newif\ifsolution\solutionfalse
% To create the solution uncomment '\solutiontrue'
\solutiontrue

\title{System Security, Autumn 2014}

\ifsolution\author{Andrei PÃ¢rvu}
\else\author{Exercise 1}\fi

\include{author}

% Some useful commands and environments
\newcommand{\includeonlyinsolution}[1]{\ifsolution#1\fi}
\usepackage{framed}
\newenvironment{solution}%
{\par{\noindent\small\textit{Solution:}}\vspace{-12pt}\begin{framed}}%
{\end{framed}\par}

\begin{document}
\maketitle

\section{Cryptography Basics}
This section will review some basic security concepts.
\begin{enumerate}[(a)]
\item Explain the terms \emph{Integrity}, \emph{Confidentiality},
  \emph{Authentication}, \emph{Authorization}, and 
  \emph{Denial of Service}.
\includeonlyinsolution{\begin{solution}
\begin{itemize}
  \item \emph{Integrity}: Prevention of unauthorized modification of information \cite{CompSec}.
  \item \emph{Confidentiality}: Prevention of unauthorized disclosure of information \cite{CompSec}.
  \item \emph{Authentication}: Verifying the identity of a given entity.
  \item \emph{Authorization}: Specifying access rights of a given entity. Required prior authentication.
  \item \emph{Denial of Service}: Prevention of authorized access to resources
  or the delaying of time-critical operations \cite{ISO7498}.
\end{itemize}
\end{solution}}

\item Why do we need both symmetric and
   asymmetric cryptography?
  \includeonlyinsolution{\begin{solution}
  Symmetric encryption has some advantages over asymmetric encryption:
  \begin{itemize}
    \item its keys are simpler and faster to generate (usually random) and do not need to have any special properties.
    \item symmetric encryption keys are smaller than asymmetric ones. This is caused by the fact that
    asymmetric keys depend on the problem of integer factorization, which, although difficult, is faster
    than the brute force method used for symmetric keys.
  \end{itemize}
  The main disadvantage of symmetric encryption is its scalability: in a group of $n$ users, in which
  each pair of users desires to communicate securely, a total of $O(n^2)$ keys are necessary. In a
  similar group in which asymmetric keys are used, a total of $O(n)$ keys are used.\\
  Also, in order to establish a common private key for communication a public key technique must
  be used to distribute the secret key. \\
  Because of these advantages and disadvantages, a combination of both symmetric and asymmetric
  keys is used for communication:
  \begin{itemize}
    \item the authentication is done using public-private keys.
    \item the ensuing communication is done using symmetric keys.
  \end{itemize}
\end{solution}}

\item Describe the following five attacks \emph{Ciphertext only} / \emph{Known plaintext} /
  \emph{Chosen plaintext} / \emph{Chosen ciphertext} / \emph{Chosen
    cipher- and plaintext}. Rank these attacks in terms of their potential to
  be successful.

\includeonlyinsolution{\begin{solution}
\begin{itemize}
  \item \emph{Ciphertext only}: the attacker has access to a set of ciphertexts, and tries to obtain
  information about the corresponding plaintexts or about the key. Ciphertext only attack, especially
  frequency analysis, was used to break early ciphers, such as transposition cipher or Vigenere cipher.
  \item \emph{Known plaintext}: the attacker has samples of both the plaintext and the corresponding
  ciphertext and is trying to obtain the key.
  \item \emph{Chosen plaintext}: the attacker has the capability to encrypt plaintexts and obtain
  the corresponding ciphertexts, its goal being to obtain information about the key.
  \item \emph{Chosen ciphertext}: the attacker has the capability of choosing a ciphertext and obtaining
  its decryption. It is presumed that this ability is no longer available when the attacker obtains
  the ciphertext it wants to decrypt.
  \item \emph{Chosen cipher and plaintext}: A combination between the previous two.

  The {\em Ciphertext only} type of attack is the least able to succeed, if one is using a modern
  block cipher or a stream cipher.\\
  The {\em Known plaintext} can be used for certain ciphers, such as the one-time pad (if an attacker
  has both the ciphertext and the plaintext he can obtain the key by applying the $xor$ operator
  between the two).\\
  The {\em Chosen plaintext} attack is more powerful than the {\em Known plaintext} one because it
  presumes that the attacker has access to a service which encrypts given plaintexts. Therefore, the
  attacker has all the information given by the {\em Known plaintext} and also has access to various
  side information such as running time of the encryption or power consumption of the device. It can
  be used for side-channel attacks.\\
  According to \cite{ModernCrypt}, the {\em Chosen ciphertext} attack is the most powerful and with
  the most potential to succeed, encryption schemes needing to be \emph{non-malleable} to prevent
  such an attack. \emph{Non-malleability} refers to "the property that if the adversary tries to
  modify a given ciphertext, the result is either an illegal ciphertext or one that encrypts a plaintext
  having no relation to the original one." \cite{ModernCrypt}.
\end{itemize}
\end{solution}}
\end{enumerate}

\section{Locking System}
A car manufacturer wants to equip his cars with a new locking system which works in
the following way: The system is composed of a small (tamper-proof) sender embedded
in the car key and a receiver in the car. When the sender goes close to the
receiver, it sends a radio frequency signal. The signal consists of 128-bit string which is the
actual cryptographic key and which will be checked by the receiver. The range of the
sender is about $20m$.

The cryptographic key length renders a brute force attack impossible and the sender
can be considered tamper-proof.
\begin{enumerate}[(a)]
\item The system seems to be as secure as a classical lock. Do you see another
possibility to break the security of the system?
\includeonlyinsolution{\begin{solution}
The problem with this method is that when the sender emits the 128-bit string, someone
else may be eavesdropping on the given frequency. Thus, the attacker can obtain the
string and later use it for opening the car.\\
This can be either done by placing a receiver in the general area of the car and picking
up the secret key when the owner comes by, or by following the owner and reading the cryptographic
key which is constantly emitted from his car key.
\end{solution}}

\item What can be done to avoid the attack you just described?
\includeonlyinsolution{\begin{solution}
There are two (possibly more) possibilities to avoid such an attack, both of them
relying on modifying the 128-bit string at every authentication:
\begin{itemize}
  \item we can maintain a pair of public-private keys, one at the receiver (car) and one
  at the sender (key). The receiver(car) can send a random generated string
  to the sender(car-key), which will encrypt it using its private key and then send
  then send it back to the receiver. The receiver can decrypt the received message using
  the key's public key and compare it with the initial one. Thus, even if someone obtains
  the decrypted string, it cannot use it later.
  \item another solution would be to use a time-synchronized one-time password, similar to the ones
  used in bank security tokens. There must exist a synchronization between the car key and the car,
  with the string that is sent from one to another changed at a fix interval of time. Thus, even if
  one message is intercepted, it cannot be used later.
\end{itemize}
\end{solution}}

\item Would your solution solve the ``relay attack'' problem as described in
  Francillion A. et. al. in their work ``Relay
  Attacks on Passive Keyless Entry and Start Systems in Modern Cars'' (\url{http://eprint.iacr.org/2010/332.pdf})?
\includeonlyinsolution{\begin{solution}
The two forms presented above would not resolve the ``relay attack'' since someone
could still amplify the signal from the key and send it to the car. To solve this,
one could use one of the solutions presented in the above article, such as adding the
possibility of disabling the sending of signals from the key to the car. This applies
to the second solution shown above, because in the first, the car is the one who initiates
the communication. Adding a button to the car would not help, as the attacker could easily
use it.
\end{solution}}
\end{enumerate}

\section{Side Channel Attacks Basics}
This section will review some important concepts underlying the side channel
attacks described in the lecture.
\begin{enumerate}[(a)]
\item What is a side channel attack?
\includeonlyinsolution{\begin{solution}
A side channel attack is an attack that uses side information leaked from an
existing implementation of a cryptosystem, other than the plaintext or the ciphertext.
This information can be either the running time of an encryption, the power consumption,
the EM emissions, the heat, etc.
\end{solution}}
\item What is the difference between simple and differential side channel
  (e.g., power, timing) analysis?
\includeonlyinsolution{\begin{solution}
Simple side channel attacks use information (power consumed or duration of execution)
during a single execution of an encryption operation. Usually they are based on looking at
the visual representation of the measured metric.\\
Differential side channel attacks, on the other hand, use statistical analysis
on partial operations of the execution of an encryption operation. They focus
on timing/power analysis on parts of the encryption/decryption algorithm, instead of the
overall execution.

\end{solution}}

\item Computers and screens emit electromagnetic waves which can be measured and
analyzed from a distance. This might allow an attacker to draw conclusions from the
processed data. On which parameters does the maximum ``attack--distance'' from the
receiver to the emission source depend?
\includeonlyinsolution{\begin{solution}
The emitted electromagnetic waves can be contained inside the corresponding devices
and thus decreasing the maximum ``attack--distance'' from the receiver to the source.
According to \cite{AttacksOnSmartcards}, measures for containing the radiation are:
metal layers added to the device/chip, blurring the emanation, introducing more
noise into the EM field and smaller dimension of transistors. Essentially, building
a Faraday cage around the device can stop these emissions, but this can be difficult
and quite unfeasible.

\end{solution}}


\end{enumerate}

\section{Simple Power Analysis Attacks on RSA}
\begin{enumerate}[(a)]

\item The ``Square and Multiply'' algorithm is commonly used to implement
  modular exponentiation. The algorithm computes the exponentiation by a
  series of squarings and multiplications. It processes the exponent bitwise,
  and for each bit, a squaring is executed. If the current bit of the exponent
  is $e_i=1$, the intermediate result is multiplied with the base $a$. \\
  What makes RSA implementations that use square and multiply (in its native
  form that we just described) vulnerable to a side channel
  attack?
\includeonlyinsolution{\begin{solution}
The vulnerability comes from the key-dependent branching. If bit $k$ of the key
is equal to one, then a multiplication and a modulo operation is done, otherwise,
just an assignment operation. Thus, the execution time depends on the number of
bits of the key.\\
Moreover, we can run the encryption algorithm for a certain key as many times
as we want, with various inputs, and compute the variance of its running time.
We can guess the first $b$ bits of the key and then, using the computed variance,
we can determine if a certain value for bit $b+1$ is correct, if the variance decreases.
\end{solution}}


\item Which platforms are most vulnerable to power-based side-channel attacks and why?
\includeonlyinsolution{\begin{solution}
The most vulnerable platforms for power-based analysis are Smartcards, RFID chips
and Sensor Nodes. This occurs because many of these devices are available for physical access
and because they don't have their own power source, but it is provided by the reader (which can
then measure it). Also, unlike PCs or larger machines, they tend to be application specific: a single
application (in our case the encryption/decryption system) runs of them, so it is easier to obtain
the desired information. This would prove difficult for a PC on which, because of task scheduling
and multiprogramming, many application/processes run.

\end{solution}}
\end{enumerate}


\section{Cache-timing Attack on AES}
\begin{enumerate}[(a)]
\item What is the vulnerability exploited in the attack described at the
  lecture? Does the vulnerability lie in the design or in the implementation of AES?
\includeonlyinsolution{\begin{solution}
  The vulnerability lies in the implementation of the AES encryption. During each of the
  $9$ rounds three different function are applied to the current state: SubBites, ShiftRows
  and MixColumns. For a fast implementation (especially on a processor with word length
  of 32) these three function can be combined into a single table lookup (this transformation
  is explained in \cite{Rijndael}).\\
  The problem lies within the table lookup: the index is key-dependent and message dependent.
  For example, the first table lookup is $T[k[0] \oplus n[0]]$, where $k[0]$ is the first byte
  of the key, and $n[0]$ is the first byte of the plaintext. The time to access a certain index
  depends on the address of the position, and whether data will be in the cache or in the main
  memory.\\
  Therefore, a system profiling can tell, for example, which value of $k[0] \oplus n[0]$ generates the maximum
  AES encryption time and then extract the key from that value and the plaintext.

\end{solution}}

\item For a $k$ byte key, how many messages would you require in theory for
  this attack? You may assume a noiseless/ideal measurement system.
\includeonlyinsolution{\begin{solution}
The number of messages send depends on the actual key used for AES, as well as
the correlations obtained from the profiling phase.\\
In \cite{CacheTiming}, to obtain an 128-bit key, the author used a number of 4196901 400-bytes,
800-bytes and 600-bytes messages in the preparation of the attack.\\
During the actual attack, he used:
\begin{itemize}
  \item $2^{25}$ 800-bytes packages
  \item $2^{25}$ 600-bytes packages
  \item $2^{27}$ 400-bytes packages
\end{itemize}

The number of packets and the size of the packets play an important role in determining
the constraints on the given key, because they provide the correlations between the bytes
of the key and the bytes of the plaintext.

\end{solution}}
\end{enumerate}

\begin{thebibliography}{1}

  \bibitem{ISO7498} International Organization for Standardization
    {\em Basic Reference Model for Open Systems Interconnection:
    Security Architecture}  1989.
  \bibitem{CompSec} Dieter Gollmann {\em Computer Security}, 2011.
  \bibitem{AttacksOnSmartcards} Adam Matthews, {\em Low Cost Attacks on Smart Cards
  The Electromagnetic Side-Channel}, 2006.
  \bibitem{Rijndael} Joan Daemen, Vincent Rijmen, {\em AES Proposal: Rijndael}, 1998
  \bibitem{ModernCrypt} Jonathan Katz, Yehuda Lindell {\em Introduction to Modern Cryptography}, 2008.
  \bibitem{CacheTiming} Daniel J. Bernstein {\em Cache-timing attacks on AES}.
\end{thebibliography}
\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
